---
title: "Metodo delle $K$-medie"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
```


### Dati Forza Lavoro

1. Importare i dati ed ottenere la matrice $X$ che contiene tutte le variabili ad esclusione di `Country` e `blocco`. 
Applicare l'algoritmo delle  K-medie (argomento `algorithm = Lloyd`) sui dati $X$ specificando $K=3$ gruppi, inizializzando i centroidi con le osservazioni di riga 1, 25 e 26. Riportare le numerosità dei gruppi ottenuti e la tabella a doppia entrata che incrocia i gruppi ottenuti con la variabile `blocco`. 

```{r}
load("/Users/aldosolari/Dropbox/Oldbox/TSC/esercitazioni tsc/slides/paesi.Rdata")

X = paesi[,-c(1,11)]
n = nrow(X)
p = ncol(X)

# K-medie
km = kmeans(X, centers = X[c(1,25,26),], algorithm = "Lloyd")

# numerosità dei gruppi
table(km$cluster)

# tabella gruppi e blocco
table(km$cluster, paesi$blocco)
```

2. Determinare i centroidi, le somme dei quadrati *within* $W$ e *between* $B$, il valore dell'indice CH di Calinski and Harabasz.

```{r}
# centroidi
km$centers

# somme dei quadrati W e B
( W = km$tot.withinss )
( B = km$betweenss )

# indice CH
K = 3
(B/(K-1)) / (W/(n-K))
```

3. Costruire il grafico *silhouette* basato sulla distanza Euclidea con la funzione `silhouette` presente nella libreria `cluster`, e commentare i risultati.

```{r}
# Silhouette
library(cluster)

# matrice delle distanze euclidee
D = dist(X, method="euclidean")

# silhouette
sil <- silhouette(x=km$cluster, dist=D)
row.names(sil) <- paesi$Country
plot(sil)
```
