---
output:
  pdf_document: default
  html_document: default
---


**3 Luglio 2018 - Analisi Esplorativa**

Cognome: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots$

Nome: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots$

Matricola: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots$

Tipologia d'esame: $\qquad \Box$ 12 CFU $\qquad$ $\Box$ 15 CFU 

\bigskip

\hrule

**Prova scritta - versione B**

*Si svolgano gli esercizi riportando il risultato dove indicato. Durata: 60 minuti*

\bigskip

\hrule

**Esercizio 1 (5 punti)**

\bigskip

Si consideri il dataset `iris` presente nella libreria `datasets` che contiene $n=150$ unità statistiche (fiori di genere Iris) relative alle $4$ variabili 

* *Sepal.Length* (lunghezza dei sepali)
* *Sepal.Width* (larghezza dei sepali)
* *Petal.Length* (lunghezza dei petali)
* *Petal.Width* (larghezza dei petali)  

più l'ultima colonna *Species* che specifica la specie (con modalità *setosa*, *versicolor* e *virginica*). 

Si consideri la matrice $\underset{150\times 4}{X}$ che contiene le seguenti variabili: *Sepal.Length*, *Sepal.Width*, *Petal.Length* e *Petal.Width*. Sulla base di questa matrice, utilizzare l'algoritmo delle K-medie (specificando `algorithm = "Lloyd"`) per formare $K=3$ gruppi, inizializzando i centroidi con le osservazioni di riga 30, 80 e 110, ed eseguendo l’algoritmo una sola volta. Riportare 
 
 \bigskip
 
a. la numerosità dei 3 gruppi ottenuti: 

\bigskip

gruppo 1 = $\ldots\ldots\quad$, gruppo 2 = $\ldots\ldots\quad$, gruppo 3 = $\ldots\ldots$

\bigskip
\bigskip

b. i valori della tabella a doppia entrata che incrocia la classificazione ottenuta e la variabile *Species*:

\begin{tabular}{cccc}
& setosa &  versicolor & virginica \\
\\
gruppo 1 & $\ldots\ldots$ & $\ldots\ldots$ & $\ldots\ldots$ \\
\\
gruppo 2 & $\ldots\ldots$ & $\ldots\ldots$ & $\ldots\ldots$\\
\\
gruppo 3 & $\ldots\ldots$ & $\ldots\ldots$ & $\ldots\ldots$\\
\end{tabular}

\bigskip
\bigskip

c. il valore medio della silhouette (\underline{arrotondando al secondo decimale}) per i tre gruppi (utilizzando il comando `silhouette` presente nella libreria `cluster`) considerando come matrice delle distanze quella ottenuta con la metrica Euclidea.


\bigskip

Valore medio silhouette per il gruppo 1 = $\ldots\ldots\quad$, gruppo 2 = $\ldots\ldots\quad$, gruppo 3 = $\ldots\ldots$



```{r, echo=F, include=T}
rm(list=ls())
X = iris[,-5]
n = nrow(X)
# vettore medie
xbar = matrix(colMeans(X), ncol=1)
km = kmeans(X, centers = X[c(30,80,110),], algorithm = "Lloyd")
table(km$cluster)
table(km$cluster, iris$Species)
D = dist(X, method = "euclidean")
require(cluster)
sil = silhouette(km$cluster, dist=D)
round( summary(sil)$ clus.avg.widths, 2)
```

\newpage

**Esercizio 2 (6 punti)**

a. Riportare le seguenti definizioni (in forma matriciale), specificando tutte le quantità coinvolte:

\vspace{0.5cm}

Vettore delle medie

\vspace{0.5cm}

Matrice di centramento

\vspace{0.5cm}

Matrice dei dati centrati 

\vspace{0.5cm}

Matrice di varianze/covarianze

\vspace{0.5cm}

Matrice dei dati standardizzati 

\vspace{0.5cm}

Matrice dei dati ortogonalizzati 

\vspace{4cm}


b. Si dimostri che $\mathrm{tr}(S) = \sum_{j=1}^{p}\lambda_j$, dove $\lambda_1,\ldots,\lambda_p$ sono gli autovalori di $S$.


\vspace{5cm}

c. Elencare le proprietà di una metrica.

\newpage


**3 Luglio 2018 - Analisi Esplorativa**

Cognome: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots$

Nome: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots$

Matricola: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots$

Tipologia d'esame: $\qquad \Box$ 12 CFU $\qquad$ $\Box$ 15 CFU 

\bigskip

\hrule

**Prova scritta - versione B**

*Si svolgano gli esercizi riportando il risultato dove indicato. Durata: 60 minuti*

\bigskip

\hrule




**Esercizio 3 (6 punti)**

Data la matrice dei dati $X=\left[\begin{tabular}{rr}
5.3 & 2.0 \\
3.9 & 2.8 \\
-2.3 & 2.6 \\
2.6 & 3.6 \\
2.5 & 3.3 \\
\end{tabular}\right]$

```{r, echo=F, include=T}
rm(list=ls())
X <- matrix(
  c(5.3,3.9,-2.3,2.6,2.5,
    2,2.8,2.6,3.6,3.3),byrow=F,
  nrow=5,ncol=2)
n <- nrow(X)
p <- ncol(X)
```

si calcolino

a. la proporzione di varianza spiegata dalla prima componente principale basata sui dati centrati, arrotondando il risultato alla \underline{terza} cifra decimale:

$$\ldots\ldots$$

```{r, echo=F, include=T}
S = var(X)*((n-1)/n)
lambda = eigen(S)$values
round(lambda[1]/sum(lambda),3)
```


b. la proporzione di varianza spiegata dalla prima componente principale basata sui dati standardizzati, arrotondando il risultato alla \underline{terza} cifra decimale:

$$\ldots\ldots$$

```{r, echo=F, include=T}
R = cor(X)
lambdaR = eigen(R)$values
round(lambdaR[1]/sum(lambdaR),3)
```

c. i punteggi delle cinque unità statistiche per la prima e la seconda componente principale basata sui dati centrati, arrotondando il risultato alla \underline{seconda} cifra decimale:

\begin{table}[h!]
\centering
\begin{tabular}{rr}
prima & seconda\\
\hline
\\
$\ldots\ldots$ & $\ldots\ldots$ \\
$\ldots\ldots$ & $\ldots\ldots$ \\
$\ldots\ldots$ & $\ldots\ldots$ \\
$\ldots\ldots$ & $\ldots\ldots$ \\
$\ldots\ldots$ & $\ldots\ldots$ \\
\end{tabular}
\end{table}

```{r, echo=F, include=T}
Y = princomp(X)$scores
round(Y,2)
```

d. il vettore delle medie per la matrice che ha come colonne i due vettori di punteggi relativi alle prime due componenti principali:
$$\ldots\ldots$$

e. la matrice di varianza/covarianza per la matrice che ha come colonne i due vettori di punteggi relativi alle prime due componenti principali, arrotondando il risultato alla \underline{seconda} cifra decimale:

\begin{table}[h!]
\centering
\begin{tabular}{rr}
$\ldots\ldots$ & $\ldots\ldots$ \\
$\ldots\ldots$ & $\ldots\ldots$ \\
\end{tabular}
\end{table}

```{r, echo=F, include=T}
round(diag(lambda),3)
```

f. si stabilisca se il vettore dei punteggi della prima componente principale ha maggiore correlazione (in valore assoluto) con la prima o la seconda colonna di $X$:

$$\ldots\ldots$$

```{r, echo=F, include=T}
cor(Y[,1],X[,1])
```



\newpage

**Esercizio 4 (2 punti)**

Presi i punti $u'_1 = (5,0)$, $u'_2 = (6,2)$ e $u'_3 = (8,4)$, si verifichi che il quadrato della distanza Euclidea non soddisfa la diseguaglianza triangolare. 

\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip

**Esercizio 5 (7 punti)**

Si considereri la seguente matrice di correlazione calcolata sulla base di $n=50$ osservazioni:

\begin{table}[ht]
\centering
\begin{tabular}{rrrrr}
  \hline
 & Murder & Assault & UrbanPop & Rape \\ 
  \hline
Murder & 1.000 & 0.802 & 0.070 & 0.564 \\ 
  Assault & 0.802 & 1.000 & 0.259 & 0.665 \\ 
  UrbanPop & 0.070 & 0.259 & 1.000 & 0.411 \\ 
  Rape & 0.564 & 0.665 & 0.411 & 1.000 \\ 
   \hline
\end{tabular}
\end{table}

a. Sulla base dalla matrice di correlazione, si stimi il modello fattoriale con $k=1$ fattori utilizzando il metodo della massima verosimiglianza senza effettuare alcuna rotazione. 
Arrontondando al terzo decimale, si riportino le stime dei pesi fattoriali:

\begin{table}[ht]
\centering
\begin{tabular}{rr}
 & Stima punteggi fattoriali\\
Murder &  \\ 
  Assault &  \\ 
  UrbanPop &  \\ 
  Rape &  \\ 
\end{tabular}
\end{table}

```{r, echo=F, include=T}
rm(list=ls())
R = round(cor(USArrests), 3)
hatLambda = matrix(factanal(covmat=R, factors=1, n.obs=50, rotation ="none")$ loadings[,], ncol=1)
round(hatLambda,3)
```

b. Si determini il punteggio fattoriale con il metodo di Thompson (arrotondando alla quarta cifra decimale) per l'unità statistica  ``Arizona'' sapendo che i suoi valori nelle quattro variabili standardizzate sono

\begin{table}[ht]
\centering
\begin{tabular}{rrrrr}
& Murder & Assault & UrbanPop & Rape\\
Arizona & 1.2426 & 0.7828 & -0.5209 & -0.0034 \\
\end{tabular}
\end{table}

$$\ldots\ldots$$

```{r, echo=F, include=T}
z = c(1.2426, 0.7828, -0.5209, -0.0034)
Rinv = solve(R)
round( t(hatLambda) %*% Rinv %*% z, 4)
```


c. Si riporti la stima delle comunalità e delle varianze specifiche per le quattro variabili, arrotondando al quarto decimale:


\begin{tabular}{rrrrr}
& Murder & Assault & UrbanPop & Rape\\
\\
Comunalità \\
Varianza specifica \\
\\
\end{tabular}

```{r, echo=F, include=T}
rbind( round(t(hatLambda)^2,3),
round( 1- t(hatLambda)^2 ,3) )
```

d. Si valuti l'opportunità di stimare un modello a 2 fattori, \underline{motivando la risposta}. 



 


