---
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Cognome: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots$ Nome: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots$ Matricola: $\ldots\ldots\ldots\ldots\ldots\ldots\ldots$ 

Tipologia d'esame: $\Box$ 12 CFU $\qquad$ $\Box$ 15 CFU 

## Prova scritta di ASM 12CFU e 15CFU - Modulo Analisi Esplorativa del 11.09.2017

*La durata della prova è di 80 minuti*.\
*Si svolgano gli esercizi 1, 2 e 3 riportando il risultato dove indicato.*

### Esercizio 1 (8 punti)

Data la seguente matrice dei dati relativa a 5 unità statistiche, 

\begin{table}[ht]
\centering
\begin{tabular}{rrr}
  \hline
 $x$ & $y$ & $z$ \\ 
  \hline
 -2 & -1 & 2 \\ 
 -1 & 1 & -1 \\
 0 & 2 & -2 \\ 
 1 & 0 & -1 \\ 
 2 & -2 & 2 \\ 
   \hline
\end{tabular}
\end{table}


arrotondando i calcoli al secondo decimale, si determini:

a. il vettore delle medie campionarie e la matrice di correlazione $R$;

c. la varianza totale di $R$ e l’indice di variabilità relativo;

b. la varianza delle tre componenti principali basate sulla matrice di correlazione $R$;

d. il punteggio relativo alla prima unità statistica per la prima componente principale sapendo che l’autovettore associato al più
grande autovalore è $(-0.22,0.71,-0.67)'$;

e. il coefficiente di correlazione lineare fra $x$ e la prima componente principale.

```{r, echo=F, include=T}
X = matrix(c(-2,-1,2, -1, 1, -1, 0, 2,-2,1,0,-1,2,-2,2),byrow=T,ncol=3)
colnames(X) = c("x","y","z")
n <- nrow(X)
# a. 
xbar = t(t(colMeans(X)))
xbar
R = round(cor(X),2)
R
# b. 
round(sum(diag(R)),2)
round(det(R),2)
# c.
lambdas = round(eigen(R)$values,2)
lambdas
# d.  
S = var(X)*((n-1)/n)
Z = scale(X, center=F, scale = sqrt(diag(S)) )
v1 = t(t(round(eigen(R)$vectors[,1],2)))
y1 = (Z %*% v1)
y1[1]
# e. 
v1[1] * sqrt(lambdas[1])
```

\newpage

### Esercizio 2 (9 punti)

Si consideri la seguente matrice di distanza:

\begin{table}[ht]
\centering
\begin{tabular}{rrrrrrr}
  \hline
 & 1 & 2 & 3 & 4 & 5 & 6 \\ 
  \hline
1 & 0 & 4 & 6 & 12 & 13 & 7 \\ 
  2 & 4 & 0 & 2 & 8 & 9 & 5 \\ 
  3 & 6 & 2 & 0 & 6 & 7 & 5 \\ 
  4 & 12 & 8 & 6 & 0 & 1 & 9 \\ 
  5 & 13 & 9 & 7 & 1 & 0 & 8 \\ 
  6 & 7 & 5 & 5 & 9 & 8 & 0 \\ 
   \hline
\end{tabular}
\end{table}

a. si determini la sequenza delle partizioni identificata secondo il metodo del legame singolo, riportando le matrici di distanza che si ottengono nei primi 3 passi della procedura;

b. si disegni il dendrogramma corrispondente al risultato ottenuto al punto precedente, identificando quando è opportuno arrestare la procedura, utilizzando come criterio il valore medio della *silhouette*;

c. si descriva l'algoritmo delle $K$-medie.

```{r, echo=F, include=T}
Dmat = matrix(c(0, 4, 6, 12, 13, 7,
4, 0, 2, 8, 9, 5,
6, 2, 0, 6, 7, 5,
12, 8, 6, 0, 1, 9,
13, 9, 7, 1, 0, 8,
7, 5, 5, 9, 8, 0), ncol=6)
D = as.dist(Dmat)
D
hc = hclust(d=D, method = "single")
# a
k1=cutree(hc, k=1)
k2=cutree(hc, k=2)
k3=cutree(hc, k=3)
k4=cutree(hc, k=4)
k5=cutree(hc, k=5)
# b. 
plot(hc)
require(cluster)
summary(silhouette(k2, dist=D))$avg.width
summary(silhouette(k3, dist=D))$avg.width
summary(silhouette(k4, dist=D))$avg.width
summary(silhouette(k5, dist=D))$avg.width
```



\newpage 

### Esercizio 3 (9 punti)

a. Si dimostri che la varianza generalizzata calcolata sulla matrice di correlazione coincide con l’indice di variabilità relativo;

b. si consideri la matrice $\displaystyle \underset{2\times 2}{A}  
= 
\left[
\begin{array}{rr}
2.2 & 0.4  \\ 
0.4 & 2.8 \\ 
\end{array}
\right]$ simmetrica e a valori reali. Si esprima questa matrice secondo il Teorema di Decomposizione Spettrale;

c. si dimostri che se le colonne della matrice dei dati centrata $\tilde{X}$ sono linearmente dipendenti (assumendo $n > p$), allora la varianza generalizzata è pari a 0.


