
---
title: '**Rappresentazioni grafiche di tre o più dimensioni**'
output:
  pdf_document:
    toc: yes
  html_document:
    theme: cosmo
    toc: yes
    toc_float: yes
---

```{r startup, include = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = T, eval= T, message=F, warning=F, error=F, comment=NA, cache=F, R.options=list(width=220))
```

# Dati Measures


Importare i dati `measures`.

```{r}
rm(list=ls())
# i dati si trovano sezione "dati" della pagina web del corso:
# potete scaricarli cliccando il tasto destro "Save as"
# oppure usare il loro URL (Uniform Resource Locator)
url <- "https://raw.githubusercontent.com/aldosolari/AE/master/dati/measure.csv"
measure <- read.csv(url)
```

1. Costruire il diagramma tridimensionale per le variabili `chest`, `waist` e `hips`,  utilizzando il comando `cloud()` che è disponibile nel pacchetto `lattice`:

```{r}
library(lattice)
cloud(chest ~ waist + hips, data=measure)
```

2. Costruire il diagramma tridimensionale colorando le unità statistiche con colori diversi a seconda del sesso.

```{r}
cloud(chest ~ waist + hips, group=gender, data=measure)
```


Funzioni R più avanzate permettono di costruire un diagramma tridimensionale interattivo:

```{r, echo=FALSE, eval=F}
library(plotly)
p <- plot_ly(measure, x = ~waist, y = ~hips, z = ~chest, color = ~gender, colors = c("pink","blue")) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = 'x = waist (vita)'),
                     yaxis = list(title = 'y = hips (fianchi)'),
                     zaxis = list(title = 'z= chest (petto)')))
p
```


3. Costruire la matrice dei diagrammi di dispersione colorando le unità statistiche con colori diversi a seconda del sesso,  e commentare. 

```{r}
column.gender <- which(names(measure)=="gender")
plot(measure[,-column.gender], col=(measure$gender=="male")+1)
```

4. Costruire le facce di Chernoff corrispondenti ai 20 individui escludendo la variabile `gender` utilizzando il comando `faces()` presente nel pacchetto `TeachingDemos`:

```{r, message=FALSE}
library("TeachingDemos")
faces(measure[,-column.gender], scale=TRUE) #scale=TRUE standardizza i dati
```

5. Rappresentare gli individui con le stelle utilizzando il comando `stars()`, aggiungendo la legenda con l’argomento `key.loc = c(12,10)`. 

```{r}
stars(measure[,-column.gender], scale=TRUE, 
      key.loc = c(12, 10)) # per posizionare la legenda alle coordinate (x,y)
```

# Dati Quakes

Il data.frame `quakes` è presente nel pacchetto `dataset`. Si tratta di 1000 osservazioni misurate su 5 variabili:

* lat		Latitude of event
*	long		Longitude
*	depth		Depth (km)
*	mag		Richter Magnitude
*	stations	Number of stations reporting

Il diagramma di dispersione per latitudine e longitudine dei terremoti, utilizzando il simbolo `.` per indicare le osservazioni, è dato da:

```{r}
data("quakes")
plot(lat ~ long, quakes, pch=".")
```


1. Costruire il diagramma di dispersione di latitudine e longitudine condizionato ai 4 intervallo di profondità disgiunti
(ottenendoli con il comando `co.intervals()`) e commentare.

```{r}
intervalli <- co.intervals(quakes$depth, number=4, overlap=0)
intervalli
coplot(lat ~ long | depth, data = quakes, given.v = intervalli, rows = 1)
```


